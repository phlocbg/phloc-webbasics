/**
 * Copyright (C) 2006-2013 phloc systems
 * http://www.phloc.com
 * office[at]phloc[dot]com
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *         http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package com.phloc.web.email;

import static org.junit.Assert.assertFalse;
import static org.junit.Assert.assertTrue;

import org.junit.Test;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import com.phloc.commons.email.EmailAddressUtils;
import com.phloc.commons.random.VerySecureRandom;

public final class EmailAddressValidatorTest
{
  private static final Logger s_aLogger = LoggerFactory.getLogger (EmailAddressValidatorTest.class);
  private static final String [] VALID = new String [] { "ph@phloc.com",
                                                        "sony2002@a1.com",
                                                        "real@inode.com",
                                                        "eb@online.ba-ca.com",
                                                        "ger.bauer@gmx.com",
                                                        "eva_pichler@gmx.com",
                                                        "bernhard_lang@gmx.com",
                                                        "florian@noe-nordberg.com",
                                                        "Friedl.Angelika@gmx.com",
                                                        "fotini.stamou@oracle.com",
                                                        "ss@vba.com.by",
                                                        "kathleen.mueller@berlin.com",
                                                        "a9506634@unet.univie.ac.at",
                                                        "renate.motschnig@univie.ac.at",
                                                        "michael.derntl@univie.ac.at",
                                                        "e9726394@stud3.tuwien.ac.at",
                                                        "alex.bartonik@aon.com",
                                                        "et@wkv.com",
                                                        "karin.schellner@univie.ac.at",
                                                        "e0327288@student.tuwien.ac.at",
                                                        "juergen.mangler@univie.ac.at",
                                                        "filegoood@cwnet.com",
                                                        "sonja.graner@gmx.com",
                                                        "fachschaft@winf.at",
                                                        "ronald.hochreiter@univie.ac.at",
                                                        "wowehe@hotmail.com",
                                                        "monika.hofer-mozelt@univie.ac.at",
                                                        "gerald.quirchmayr@univie.ac.at",
                                                        "alexander.petzmann@boc-eu.com",
                                                        "kinga_kovacs@hotmail.com",
                                                        "synprak@hotmail.com",
                                                        "boris.gregorcic@boc-eu.com",
                                                        "markus.arbeiter@aon.com",
                                                        "robert.klose@boc-de.com",
                                                        "uli@dke.univie.ac.at",
                                                        "katjagoerlitz@web.com",
                                                        "johannes.lischka@univie.ac.at",
                                                        "harald.kuehn@boc-eu.com",
                                                        "sylvia.sachs-gabitzer@chello.com",
                                                        "ewald.augustin@boc-eu.com",
                                                        "vk@Informatik.TU-Cottbus.de",
                                                        "nmixalop@cs.teiath.gr",
                                                        "lukas.ramach@boc-eu.com",
                                                        "jorma.lehmann@boc-de.com",
                                                        "support@kontent.com",
                                                        "lukas.ramach@inode.com",
                                                        "karintje@gmx.com",
                                                        "rene@voglmayr.com",
                                                        "hannes.stieger@orf.at",
                                                        "Elisabeth.Huber@voestalpine.com",
                                                        "andrea.schoenthoner@univie.ac.at",
                                                        "elfiz@directbox.com",
                                                        "Viktoria.Duda@wu-wien.ac.at",
                                                        "v_merlingen@hotmail.com",
                                                        "michaelkrist@hotmail.com",
                                                        "koos.vanmeel@gmx.com",
                                                        "c.kleinhans@gmx.com",
                                                        "sonja.duspara@univie.ac.at",
                                                        "roland.bauer@univie.ac.at",
                                                        "ross.king@univie.ac.at",
                                                        "manfred.hackl@ec3.com",
                                                        "brezany@par.univie.ac.at",
                                                        "g.humpel@aon.com",
                                                        "Sonja.Duspara@univie.ac.at",
                                                        "Blazevic@gmx.com",
                                                        "hans-georg.fill@dke.univie.ac.at",
                                                        "peter.hoefferer@dke.univie.ac.at",
                                                        "loora102@hotmail.com",
                                                        "Roswitha.Pilhatsch@stbh.gv.at",
                                                        "jan.stankovsky@univie.ac.at",
                                                        "hkuehn@dke.univie.ac.at",
                                                        "erika.gaida@boc-eu.com",
                                                        "christian.fabsich@boc-eu.com",
                                                        "dwball55@yahoo.com",
                                                        "ch@mminf.univie.ac.at",
                                                        "michael.geipel@boc-eu.com",
                                                        "tobias.rausch@boc-at.com",
                                                        "karintje@gmx.com",
                                                        "office@itimshop.com",
                                                        "deert@gmx.com",
                                                        "info@itimshop.com",
                                                        "florian.bartl@boc-eu.com",
                                                        "LocutusOfBorg@gmx.com",
                                                        "dorel.coban@boc-eu.com",
                                                        "iridium77@gmx.com",
                                                        "hofmann@lfrz.com",
                                                        "bst13@wgkk.com",
                                                        "Robertooo@gmx.com",
                                                        "singer@meistersinger.com",
                                                        "Wolfgang.Hofmann@lfrz.com",
                                                        "ph@phloc.com",
                                                        "georg.binder@gmx.com",
                                                        "a9500532@unet.univie.ac.at",
                                                        "franz@staffel.com",
                                                        "ines.wild@gmx.com",
                                                        "gerald.weihs@gmx.com",
                                                        "silke.palkovits@chello.com",
                                                        "derivatebuch@trinkaus.com",
                                                        "stepan.seycek@boc-eu.com",
                                                        "phloc@yahoogroups.com",
                                                        "martl.fischer@aon.com",
                                                        "Sylvia.Sachs-Gabitzer@brz.gv.at",
                                                        "fayestamou@yahoo.co.uk",
                                                        "helkohl@wanadoo.fr",
                                                        "mahr@imw.tuwien.ac.at",
                                                        "Markus_Arbeiter@aon.com",
                                                        "mathilde@cefres.cz",
                                                        "wenzina@imw.tuwien.ac.at",
                                                        "klaus.steininger@gmx.com",
                                                        "Richard.Hartl@univie.ac.at",
                                                        "mschein@dke.univie.ac.at",
                                                        "robert.sarkezi@boc-eu.com",
                                                        "allsilver@gmx.com",
                                                        "judit@dke.univie.ac.at",
                                                        "wolfgang.klas@univie.ac.at",
                                                        "albert.schwingenschloegl@univie.ac.at",
                                                        "michael.krist@t-mobile.com",
                                                        "atomek@winf.at",
                                                        "mjerry@gmx.com",
                                                        "lydia.weber@boc-eu.com",
                                                        "alexander@koerber.com",
                                                        "babsi.fischer@aon.com",
                                                        "boehmer@hep.itp.tuwien.ac.at",
                                                        "Andreas.Steurer@brz.gv.at",
                                                        "simon@tjoa.com",
                                                        "heuriger@koerber.com",
                                                        "koerbersheuriger@hotmail.com",
                                                        "infoa526@winf.univie.ac.at",
                                                        "monika.goralczyk@paybox.com",
                                                        "K.Rautz@mobilkom.com",
                                                        "herwig.kummer@univie.ac.at",
                                                        "gettyp@yahoogroups.com",
                                                        "Partylex@a1.com",
                                                        "kremmel.thomas@a1.com",
                                                        "wuz1@gmx.com",
                                                        "philipp.liegl@gmx.com",
                                                        "thomas.kremmel@gmail.com",
                                                        "wolfgang.schuessel@bka.gv.at",
                                                        "elisabeth.gehrer@bmbwk.gv.at",
                                                        "aeiou-info@iicm.edu",
                                                        "dna@dna.com",
                                                        "e318@ihrt.tuwien.ac.at",
                                                        "mariammotamen@gmx.com",
                                                        "chaag@mti.com",
                                                        "patrick.pfister@chello.com",
                                                        "a0301685@unet.univie.ac.at",
                                                        "katja.goerlitz@gmx.com",
                                                        "silvia.bojinova@chello.com",
                                                        "rainer@rain-star.com",
                                                        "marco@mminf.univie.ac.at",
                                                        "a0206513@unet.univie.ac.at",
                                                        "moser.christian@gmx.com",
                                                        "sylvia.sachs@gmx.com",
                                                        "bpanda@stratify.com",
                                                        "info@koli-bri.com",
                                                        "e.kreindl@poetz99.at",
                                                        "michael@mgottwald.com",
                                                        "a0202302@unet.univie.ac.at",
                                                        "xphilippx@gmx.com",
                                                        "Nico_Dittberner@web.com",
                                                        "a9925729@unet.univie.ac.at",
                                                        "e0226248@student.tuwien.ac.at",
                                                        "hannes.schweiger@kulturundsprache.com",
                                                        "zapletal@mminf.univie.ac.at",
                                                        "werner.enzenhofer@austrex.com",
                                                        "nico_dittberner@web.com",
                                                        "nmichalopoulos@boc-gr.com",
                                                        "info@roesener.com",
                                                        "juergen.roesener@roesener.com",
                                                        "elaien@gmx.com",
                                                        "dennis@io-software.nl",
                                                        "dorit_kaikov@hotmail.com",
                                                        "stefan.schneeberger@boc-eu.com",
                                                        "stephan.schneeberger@boc-eu.com",
                                                        "zuse@gmx.com",
                                                        "kovacs@hanken.fi",
                                                        "bodo63@gmx.com",
                                                        "principe@mails.com",
                                                        "donnamolinari@bluewin.ch",
                                                        "dorithaubenhofer@web.com",
                                                        "team1@koli-bri.com",
                                                        "qingpu2@gmail.com",
                                                        "ark@mos.ru",
                                                        "anita.engel@boc-eu.com",
                                                        "Gerhard.Trimbacher@helvetia.com",
                                                        "abo@heise.com",
                                                        "rayeden@gmail.com",
                                                        "support@avast.com",
                                                        "marianne.gaertner@ewetel.com",
                                                        "cdub@dke.univie.ac.at",
                                                        "webmaster@kr.tuwien.ac.at",
                                                        "ocg@ocg.at",
                                                        "gitju@gmx.com",
                                                        "robert.woitsch@boc-eu.com",
                                                        "chris_u@gmx.com",
                                                        "webmaster@boc-eu.com",
                                                        "Berthold.Peck@brz.gv.at",
                                                        "info@kontent.com",
                                                        "Gernot.Habel@gmx.com",
                                                        "benjamin.ferrari@gmail.com",
                                                        "phex100@aon.com",
                                                        "ssd1@googlegroups.com",
                                                        "rr@bttr-software.com",
                                                        "xerl@mminf.univie.ac.at",
                                                        "nre@nre.com",
                                                        "ml@mexx.cc",
                                                        "gerry@par.univie.ac.at",
                                                        "wolfgang.kaghofer@boc-eu.com",
                                                        "m.loeberbauer@scharpenack.com",
                                                        "Alexander.Gunka@boc-eu.com",
                                                        "wilfrid.utz@boc-eu.com",
                                                        "kalina.chivarova@boc-eu.com",
                                                        "wanek@chello.com",
                                                        "Kalina.Chivarova@boc-eu.com",
                                                        "Bewerbung@brz.gv.at",
                                                        "marion.bauer@gmail.com",
                                                        "brigitte.heichinger@univie.ac.at",
                                                        "sigi@par.univie.ac.at",
                                                        "uwe@kr.tuwien.ac.at",
                                                        "monika.goralczyk@gmx.com",
                                                        "markus_pitsch@gmx.com",
                                                        "snakeman@netspace.net.au",
                                                        "h.redler@wvb-evang.com",
                                                        "wolfgang@helger.com",
                                                        "dilemma4@gmx.com",
                                                        "a9901799@hotmail.com",
                                                        "christian.kneidinger@ooe.gv.at",
                                                        "telesales@nre.com",
                                                        "a.jakab@gmx.com",
                                                        "vivek200120@users.sourceforge.com",
                                                        "krishna.vivek@gmail.com",
                                                        "mexx73@gmx.com",
                                                        "alex@waltschek.com",
                                                        "harald.huebner@gmx.com",
                                                        "a0102820@unet.univie.ac.at",
                                                        "benjamin.ferrari@knallgrau.com",
                                                        "thomas.hammerl@knallgrau.com",
                                                        "pichler@dbai.tuwien.ac.at",
                                                        "philip@dke.univie.ac.at",
                                                        "handelshop24-de@web.com",
                                                        "mlamp@gmx.com",
                                                        "murzek@wit.tuwien.ac.at",
                                                        "mocalissia@yahoo.com",
                                                        "martin.povazay@psolutions.com",
                                                        "andreas_stein@gmx.com",
                                                        "Andreas_Stein@gmx.com",
                                                        "wolfgang.jaeger@r-it.at",
                                                        "psycho@gmx.com",
                                                        "info@24store.com",
                                                        "thomas.koeltringer@inso.tuwien.ac.at",
                                                        "info@uma.com",
                                                        "marion@winf.at",
                                                        "a0103376@unet.univie.ac.at",
                                                        "gerhard.preisinger@gmx.com",
                                                        "htran@infosys.tuwien.ac.at",
                                                        "jan.rath@boc-eu.com",
                                                        "wolfgang.jaeger@r-it.at",
                                                        "dk@dke.univie.ac.at",
                                                        "Michael.Ziehensack@boc-eu.com",
                                                        "gerald.ernecker@gmx.com",
                                                        "mrichter@inode.com",
                                                        "Markus.oberwinkler@gmx.com",
                                                        "Koos.vanMeel@gmx.com",
                                                        "michael.ziehensack@boc-eu.com",
                                                        "marionbauer@gmx.com",
                                                        "e0026334@student.tuwien.ac.at",
                                                        "e0160243@student.tuwien.ac.at",
                                                        "m.cem@24on.cc",
                                                        "bg@phloc.com",
                                                        "m.geipel@gmx.com",
                                                        "lr@phloc.com",
                                                        "alexander.bartonik@boc-eu.com",
                                                        "t.guggenberger@j-it.com",
                                                        "sabine_eder@gmx.com",
                                                        "e9930578@student.tuwien.ac.at",
                                                        "e0105668@student.tuwien.ac.at",
                                                        "p.gruber@aon.com",
                                                        "e9930578@stud4.tuwien.ac.at",
                                                        "181139+156311@tuwislist.tuwien.ac.at",
                                                        "silvia.ledoldis@aon.com",
                                                        "e9901261@student.tuwien.ac.at",
                                                        "m_cer@aon.com",
                                                        "jakl.michael@gmail.com",
                                                        "e9952266@student.tuwien.ac.at",
                                                        "jan.rath@gmx.com",
                                                        "barsel@gmx.com",
                                                        "gtopala@hotmail.com",
                                                        "markus.oberwinkler@gmx.com",
                                                        "marion.bauer@austrocontrol.com",
                                                        "gernot.habel@gmx.com",
                                                        "Support.de@BenQ.com",
                                                        "basti.fischer@aon.com",
                                                        "alexander.gunka@boc-eu.com",
                                                        "sonjawurst@gmx.com",
                                                        "sebastiangamauf@gmx.com",
                                                        "Andreas.Priester@aua.com",
                                                        "karin.schuh@gmx.com",
                                                        "gabriela.perstinger@gmx.com",
                                                        "g.tiefenbacher@gmx.com",
                                                        "Brigitte.Fuernkranz@gmx.com",
                                                        "birgit.neuhold@egston.com",
                                                        "beate.zelni@gmx.com",
                                                        "astrid.winnisch@gmx.com",
                                                        "annalene@gmx.com",
                                                        "friedl.angelika@gmx.com",
                                                        "andrea.e@a1.com",
                                                        "alex_satzinger@hotmail.com",
                                                        "ingrid_schmidt@yahoo.com",
                                                        "gerold.weber@rsc.co.com",
                                                        "g-neuwirth@aon.com",
                                                        "stefan.junginger@boc-de.com",
                                                        "Andreas.Priester@austrian.com",
                                                        "kai.eckert@boc-de.com",
                                                        "astrong@coverity.com",
                                                        "s.iris@inode.com",
                                                        "kraeuter.pfarrer@aon.com",
                                                        "dr.schmid@e-gig.com",
                                                        "elvisfan85@hotmail.com",
                                                        "grazl@gmx.com",
                                                        "soegner@imw.tuwien.ac.at",
                                                        "Hasan.Kilic@reflex.com",
                                                        "christian.kloner@aon.com",
                                                        "davidgiefing@yahoo.com",
                                                        "stehu@chello.com",
                                                        "swuensch@fh-eberswalde.com",
                                                        "e0047649@student.tuwien.ac.at",
                                                        "fasterfox@mozdev.org",
                                                        "uid-abgabe@inso.tuwien.ac.at",
                                                        "a0247640@unet.univie.ac.at",
                                                        "dani.stawik@utanet.com",
                                                        "mario.dani@laric.com",
                                                        "gewinn@pulstv.com",
                                                        "uid@inso.tuwien",
                                                        "uid@inso.tuwien.ac.at",
                                                        "rainer.schmidt@gmail.com",
                                                        "mauersegler@yahoo.com",
                                                        "wildweb@gmx.com",
                                                        "ivaylo.kassabov@chsh.com",
                                                        "gerald.schneeweiss@univie.ac.at",
                                                        "webleyandreas@gmx.com",
                                                        "c.dorfinger@acctus.com",
                                                        "martin.tomitsch@inso.tuwien.ac.at",
                                                        "hergen.oltmann@itemis.com",
                                                        "office@global-it.com",
                                                        "katharina.niedermayr@ecotec-computer.com",
                                                        "nokiakiller@gmx.com",
                                                        "bewi@kabsi.com",
                                                        "pioareno@gmx.com",
                                                        "hotline31@gls-austria.com",
                                                        "babsi.fischer@inode.com",
                                                        "basti.fischer@inode.com",
                                                        "anita.engel@phloc.com",
                                                        "erich.schikuta@univie.ac.at",
                                                        "office@bilcom.at",
                                                        "georg.grabherr@univie.ac.at",
                                                        "a0001286@unet.univie.ac.at",
                                                        "d.remsak@cantat.com",
                                                        "g.remsak@cantat.com",
                                                        "i.krastev@kabsi.com",
                                                        "auto@phloc.com",
                                                        "markus@arbeiter.com",
                                                        "deco@inso.tuwien.ac.at",
                                                        "soegner@mail.imw.tuwien.ac.at",
                                                        "karin.kappel@inso.tuwien.ac.at",
                                                        "Wilfrid.Utz@boc-eu.com",
                                                        "eren.kilic@bilcom.at",
                                                        "aboservice@saz.com",
                                                        "auto@phloc.com",
                                                        "s.seycek@dimoco.com",
                                                        "a.simsek@inode.com",
                                                        "akinomblack@gmx.com",
                                                        "events@dke.univie.ac.at",
                                                        "leitner@ocg.at",
                                                        "Sandra.Leitner@ocg.at",
                                                        "Events@dke.univie.ac.at",
                                                        "theperfumedgarden@gmx.com",
                                                        "tom@paniert.com",
                                                        "kurfuerst.muenzhandel@t-online.com",
                                                        "thekingant@users.sourceforge.com",
                                                        "martl.fischer@inode.com",
                                                        "andreas.steurer@gmail.com",
                                                        "p.lechner@aon.com",
                                                        "gerald.humpel@donauklinikum.com",
                                                        "berthold.peck@gmail.com",
                                                        "support@recaptcha.com",
                                                        "af@koli-bri.com",
                                                        "bm.koch@online.com",
                                                        "helmut.buehrer@extern.brz.gv.at",
                                                        "helmut.buehrer@gmx.com",
                                                        "tom@www.paniert.com",
                                                        "stefan.brezina@boc-eu.com",
                                                        "Josef.Kubin@ebcont.com",
                                                        "buchhaltung@koli-bri.com",
                                                        "vk@koli-bri.com",
                                                        "bt@koli-bri.com",
                                                        "office@foto-video.com",
                                                        "michael.dietrich@sap.com",
                                                        "markus.dehlinch@brz.gv.at",
                                                        "hotline@phloc.com",
                                                        "dietronic@t-online.com",
                                                        "office@phloc.com",
                                                        "nclark@pingidentity.com",
                                                        "depesche@jokers.com",
                                                        "Johanna.Bauer@gmx.com",
                                                        "w.kreindl@poetz99.at",
                                                        "thomasbb@gmx.com",
                                                        "office@wedermann.co.com",
                                                        "keita@gmx.com",
                                                        "ian@fightingforalostcause.com",
                                                        "mail@praszl.at",
                                                        "wuzzler.stadtbahn@gmx.at",
                                                        "peter.lechner@donauklinikum.com",
                                                        "helger.wolfgang@litef.com",
                                                        "ulrike.starkl@starkl.com",
                                                        "ilka.maenner-franziskonelli@sparkasse-freiburg.com",
                                                        "birgit.fiereder@gmx.com",
                                                        "cafe.stadtbahn@gmx.com",
                                                        "diana.leske@sparkasse-freiburg.com",
                                                        "frick.alex@gmx.com",
                                                        "info@ebox.com",
                                                        "g.schopfhauser@starkl.com",
                                                        "buero.hammer@utanet.com",
                                                        "ashot@devicelock.com",
                                                        "autodata@inode.com",
                                                        "Michael.Schlacher@gmx.com",
                                                        "s.iris@tele2.com",
                                                        "heise@zenit-presse.com",
                                                        "viplounge@puls4.com",
                                                        "michaela.paulhart@puls4.com",
                                                        "kaan@bilcom.at",
                                                        "chris_katz@msn.com",
                                                        "support@ebox.com",
                                                        "contact@cantat.com",
                                                        "claus.reinprecht@ebox.com",
                                                        "office@cantat.com",
                                                        "willinger@goeg.com",
                                                        "mp@psolutions.com",
                                                        "a.bartonik@inode.com",
                                                        "ulrich.stuerzlinger@basler.co.com",
                                                        "m.kneidinger@aon.com",
                                                        "crashreports@tortoisesvn.tigris.org",
                                                        "michael.fabigan@nre.com",
                                                        "gregory.pemptroad@boc-eu.com",
                                                        "rene.puchas@basler.co.com",
                                                        "c.birnbaumer@cantat.com",
                                                        "thomas.reis@brz.gv.at",
                                                        "g.koehle@gmx.com",
                                                        "marion.murzek@boc-eu.com",
                                                        "nigg@nigg.com",
                                                        "peter@mor.at",
                                                        "Franz.Kramer@unicreditgroup.com",
                                                        "markus@schwaha.com",
                                                        "newsletter@vienna-camera.com",
                                                        "a9601510@unet.univie.ac.at",
                                                        "templ@gmx.com",
                                                        "info@digitrend.com",
                                                        "SmartSave@ati.com",
                                                        "airtodo@users.sourceforge.com",
                                                        "airtodo@gmail.com",
                                                        "grc@chello.com",
                                                        "grs@chello.com",
                                                        "mvk@victoria.com",
                                                        "vk@victoria.com",
                                                        "irene.abbassi@gmx.com",
                                                        "christian.birnbaumer@chello.com",
                                                        "c.jinfeng@yahoo.com",
                                                        "business-support@inode.com",
                                                        "dorelcoban@hotmail.com",
                                                        "werner.ranisch@unicreditgroup.com",
                                                        "rene.puchas@gmx.com",
                                                        "info@zkoss.org",
                                                        "F.Kramer@gmx.com",
                                                        "software@informaction.com",
                                                        "g.maone@informaction.com",
                                                        "kenneth@alfa1lab.com",
                                                        "franz.schiemer@univie.ac.at",
                                                        "friedrich.schiemer@univie.ac.at",
                                                        "michael@nadev.com",
                                                        "franz.kramer@unicreditgroup.com",
                                                        "it@ebox.com",
                                                        "Gerald.Humpel@tulln.lknoe.at",
                                                        "orangeshop.hietzing@orange.co.com",
                                                        "ffse-unsubscribe@yahoogroups.com",
                                                        "confirm-unsub-snyvgsgufmxnbmyrb1r44kgqh0hef5vf@yahoogroups.com",
                                                        "a0001342@unet.univie.ac.at",
                                                        "rechnung@kontent.com",
                                                        "carl-markus@piswanger.com",
                                                        "dimitrios.missios@uniqa.com",
                                                        "kurt.frosch@wienkav.com",
                                                        "wilfrid@utz.co.com",
                                                        "neubaugasse@stefanbrandt.com",
                                                        "lu@koli-bri.com",
                                                        "gene@gerd-neugebauer.com",
                                                        "subscribe@javaspecialists.com",
                                                        "helmut.fleissner@liwest.at",
                                                        "karin_enzenhofer@gmx.com",
                                                        "support@kontent.com",
                                                        "Heinz.Templ@lansky.com",
                                                        "koehler@par.univie.ac.at",
                                                        "jeanyen@zkoss.org" };
  private static final String [] INVALID = new String [] { "ph@phloc", "karin_enzenhofer@gmx-net" };

  @Test
  public void testWithoutMXCheck ()
  {
    for (final String sValid : VALID)
      assertTrue (sValid, EmailAddressUtils.isValid (sValid));
    for (final String sInvalid : INVALID)
      assertFalse (sInvalid, EmailAddressUtils.isValid (sInvalid));
  }

  @Test
  public void testWithMXCheck ()
  {
    // Note: not all email addresses provided are valid so there may not
    // necessarily be MX records! But there should not be more than 5 warnings
    // (in average 2-3)
    for (int i = 0; i < 20; ++i)
    {
      final int nIndex = VerySecureRandom.getInstance ().nextInt (VALID.length);
      final String sValid = VALID[nIndex];
      if (!EmailAddressValidator.isValidWithMXCheck (sValid))
        s_aLogger.info ("No MX record for: " + sValid);
    }
  }
}
