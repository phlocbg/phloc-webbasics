(function(g){var w,x,s,y,z,A,B,C,D,E,F,G,H,I,e={isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(b){return!b||/^\s*$/.test(b)},escapeRegExChars:function(b){return b.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(b){return"string"===typeof b},isNumber:function(b){return"number"===typeof b},isArray:g.isArray,isFunction:g.isFunction,isObject:g.isPlainObject,isUndefined:function(b){return"undefined"===
typeof b},bind:g.proxy,each:function(b,e){g.each(b,function(b,c){return e(c,b)})},map:g.map,filter:g.grep,every:function(b,e){var d=!0;if(!b)return d;g.each(b,function(c,a){if(!(d=e.call(null,a,c,b)))return!1});return!!d},some:function(b,e){var d=!1;if(!b)return d;g.each(b,function(c,a){if(d=e.call(null,a,c,b))return!1});return!!d},mixin:g.extend,getUniqueId:function(){var b=0;return function(){return b++}}(),templatify:function(b){function e(){return String(b)}return g.isFunction(b)?b:e},defer:function(b){setTimeout(b,
0)},debounce:function(b,e,d){var c,a;return function(){var k=this,f=arguments,p;p=d&&!c;clearTimeout(c);c=setTimeout(function(){c=null;d||(a=b.apply(k,f))},e);p&&(a=b.apply(k,f));return a}},throttle:function(b,e){var d,c,a,k,f,p;f=0;p=function(){f=new Date;a=null;k=b.apply(d,c)};return function(){var r=new Date,l=e-(r-f);d=this;c=arguments;0>=l?(clearTimeout(a),a=null,f=r,k=b.apply(d,c)):a||(a=setTimeout(p,l));return k}},noop:function(){}},O=function(b){function e(a){return a.split(/\s+/)}function d(a){return a.split(/\W+/)}
function c(a){return function(k){return function(f){return a(f[k])}}}return{nonword:d,whitespace:e,obj:{nonword:c(d),whitespace:c(e)}}}(),J=function(){function b(c){this.maxSize=c||100;this.size=0;this.hash={};this.list=new g}function g(){this.head=this.tail=null}function d(c,a){this.key=c;this.val=a;this.prev=this.next=null}e.mixin(b.prototype,{set:function(c,a){var k=this.list.tail;this.size>=this.maxSize&&(this.list.remove(k),delete this.hash[k.key]);(k=this.hash[c])?(k.val=a,this.list.moveToFront(k)):
(k=new d(c,a),this.list.add(k),this.hash[c]=k,this.size++)},get:function(c){if(c=this.hash[c])return this.list.moveToFront(c),c.val}});e.mixin(g.prototype,{add:function(c){this.head&&(c.next=this.head,this.head.prev=c);this.head=c;this.tail=this.tail||c},remove:function(c){c.prev?c.prev.next=c.next:this.head=c.next;c.next?c.next.prev=c.prev:this.tail=c.prev},moveToFront:function(c){this.remove(c);this.add(c)}});return b}(),P=function(){function b(a){this.prefix=["__",a,"__"].join("");this.ttlKey=
"__ttl__";this.keyMatcher=RegExp("^"+this.prefix)}function g(a){return JSON.stringify(e.isUndefined(a)?null:a)}var d;try{d=window.localStorage,d.setItem("~~~","!"),d.removeItem("~~~")}catch(c){d=null}e.mixin(b.prototype,d&&window.JSON?{_prefix:function(a){return this.prefix+a},_ttlKey:function(a){return this._prefix(a)+this.ttlKey},get:function(a){this.isExpired(a)&&this.remove(a);a=d.getItem(this._prefix(a));return JSON.parse(a)},set:function(a,k,f){e.isNumber(f)?d.setItem(this._ttlKey(a),g((new Date).getTime()+
f)):d.removeItem(this._ttlKey(a));return d.setItem(this._prefix(a),g(k))},remove:function(a){d.removeItem(this._ttlKey(a));d.removeItem(this._prefix(a));return this},clear:function(){var a,k,f=[],c=d.length;for(a=0;a<c;a++)(k=d.key(a)).match(this.keyMatcher)&&f.push(k.replace(this.keyMatcher,""));for(a=f.length;a--;)this.remove(f[a]);return this},isExpired:function(a){a=d.getItem(this._ttlKey(a));a=JSON.parse(a);return e.isNumber(a)&&(new Date).getTime()>a?!0:!1}}:{get:e.noop,set:e.noop,remove:e.noop,
clear:e.noop,isExpired:e.noop});return b}(),L=function(){function b(a){a=a||{};this._send=a.transport?h(a.transport):g.ajax;this._get=a.rateLimiter?a.rateLimiter(this._get):this._get}function h(a){return function(k,c){var b=g.Deferred();a(k,c,function(a){e.defer(function(){b.resolve(a)})},function(a){e.defer(function(){b.reject(a)})});return b}}var d=0,c={},a=6,k=new J(10);b.setMaxPendingRequests=function(f){a=f};b.resetCache=function(){k=new J(10)};e.mixin(b.prototype,{_get:function(f,b,e){function l(a){e&&
e(null,a);k.set(f,a)}function g(){e&&e(!0)}function h(){d--;delete c[f];n.onDeckRequestArgs&&(n._get.apply(n,n.onDeckRequestArgs),n.onDeckRequestArgs=null)}var n=this,K;(K=c[f])?K.done(l).fail(g):d<a?(d++,c[f]=this._send(f,b).done(l).fail(g).always(h)):this.onDeckRequestArgs=[].slice.call(arguments,0)},get:function(a,c,b){var d;e.isFunction(c)&&(b=c,c={});(d=k.get(a))?e.defer(function(){b&&b(null,d)}):this._get(a,c,b);return!!d}});return b}(),Q=function(){function b(a){a=a||{};a.datumTokenizer&&a.queryTokenizer||
g.error("datumTokenizer and queryTokenizer are both required");this.datumTokenizer=a.datumTokenizer;this.queryTokenizer=a.queryTokenizer;this.reset()}function h(a){a=e.filter(a,function(a){return!!a});return a=e.map(a,function(a){return a.toLowerCase()})}function d(a){for(var c={},f=[],b=0;b<a.length;b++)c[a[b]]||(c[a[b]]=!0,f.push(a[b]));return f}function c(a,c){function f(a,f){return a-f}var b=0,d=0,e=[];a=a.sort(f);for(c=c.sort(f);b<a.length&&d<c.length;)a[b]<c[d]?b++:(a[b]>c[d]||(e.push(a[b]),
b++),d++);return e}e.mixin(b.prototype,{bootstrap:function(a){this.datums=a.datums;this.trie=a.trie},add:function(a){var c=this;a=e.isArray(a)?a:[a];e.each(a,function(a){var b;b=c.datums.push(a)-1;a=h(c.datumTokenizer(a));e.each(a,function(a){var f,d;f=c.trie;for(a=a.split("");d=a.shift();)f=f.children[d]||(f.children[d]={ids:[],children:{}}),f.ids.push(b)})})},get:function(a){var k=this,f;a=h(this.queryTokenizer(a));e.each(a,function(a){var b,d;if(f&&0===f.length)return!1;b=k.trie;for(a=a.split("");b&&
(d=a.shift());)b=b.children[d];if(b&&0===a.length)b=b.ids.slice(0),f=f?c(f,b):b;else return f=[],!1});return f?e.map(d(f),function(a){return k.datums[a]}):[]},reset:function(){this.datums=[];this.trie={ids:[],children:{}}},serialize:function(){return{datums:this.datums,trie:this.trie}}});return b}(),u=function(){return{local:function(b){return b.local||null},prefetch:function(b){var h;h={url:null,thumbprint:"",ttl:864E5,filter:null,ajax:{}};if(b=b.prefetch||null)b=e.isString(b)?{url:b}:b,b=e.mixin(h,
b),b.thumbprint="0.10.2"+b.thumbprint,b.ajax.type=b.ajax.type||"GET",b.ajax.dataType=b.ajax.dataType||"json",!b.url&&g.error("prefetch requires url to be set");return b},remote:function(b){function h(a){return function(c){return e.debounce(c,a)}}function d(a){return function(c){return e.throttle(c,a)}}var c;c={url:null,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}};if(b=b.remote||null)b=e.isString(b)?{url:b}:b,b=e.mixin(c,b),b.rateLimiter=/^throttle$/i.test(b.rateLimitBy)?
d(b.rateLimitWait):h(b.rateLimitWait),b.ajax.type=b.ajax.type||"GET",b.ajax.dataType=b.ajax.dataType||"json",delete b.rateLimitBy,delete b.rateLimitWait,!b.url&&g.error("remote requires url to be set");return b}}}();(function(b){function h(a){a&&(a.local||a.prefetch||a.remote)||g.error("one of local, prefetch, or remote is required");this.limit=a.limit||5;this.sorter=d(a.sorter);this.dupDetector=a.dupDetector||c;this.local=u.local(a);this.prefetch=u.prefetch(a);this.remote=u.remote(a);this.cacheKey=
this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null;this.index=new Q({datumTokenizer:a.datumTokenizer,queryTokenizer:a.queryTokenizer});this.storage=this.cacheKey?new P(this.cacheKey):null}function d(a){function c(f){return f.sort(a)}function b(a){return a}return e.isFunction(a)?c:b}function c(){return!1}var a;a=b.Bloodhound;b.Bloodhound=h;h.noConflict=function(){b.Bloodhound=a;return h};h.tokenizers=O;e.mixin(h.prototype,{_loadPrefetch:function(a){function c(f){b.clear();b.add(a.filter?
a.filter(f):f);b._saveToStorage(b.index.serialize(),a.thumbprint,a.ttl)}var b=this,d;(d=this._readFromStorage(a.thumbprint))?(this.index.bootstrap(d),d=g.Deferred().resolve()):d=g.ajax(a.url,a.ajax).done(c);return d},_getFromRemote:function(a,c){var b=this,d;a=a||"";d=encodeURIComponent(a);d=this.remote.replace?this.remote.replace(this.remote.url,a):this.remote.url.replace(this.remote.wildcard,d);return this.transport.get(d,this.remote.ajax,function(a,k){a?c([]):c(b.remote.filter?b.remote.filter(k):
k)})},_saveToStorage:function(a,c,b){this.storage&&(this.storage.set("data",a,b),this.storage.set("protocol",location.protocol,b),this.storage.set("thumbprint",c,b))},_readFromStorage:function(a){var c,b,d;this.storage&&(c=this.storage.get("data"),b=this.storage.get("protocol"),d=this.storage.get("thumbprint"));a=d!==a||b!==location.protocol;return c&&!a?c:null},_initialize:function(){function a(){c.add(e.isFunction(b)?b():b)}var c=this,b=this.local,d;d=this.prefetch?this._loadPrefetch(this.prefetch):
g.Deferred().resolve();b&&d.done(a);this.transport=this.remote?new L(this.remote):null;return this.initPromise=d.promise()},initialize:function(a){return!this.initPromise||a?this._initialize():this.initPromise},add:function(a){this.index.add(a)},get:function(a,c){function b(a){var k=g.slice(0);e.each(a,function(a){!e.some(k,function(c){return d.dupDetector(a,c)})&&k.push(a);return k.length<d.limit});c&&c(d.sorter(k))}var d=this,g=[],h=!1,g=this.index.get(a),g=this.sorter(g).slice(0,this.limit);g.length<
this.limit&&this.transport&&(h=this._getFromRemote(a,b));h||(0<g.length||!this.transport)&&c&&c(g)},clear:function(){this.index.reset()},clearPrefetchCache:function(){this.storage&&this.storage.clear()},clearRemoteCache:function(){this.transport&&L.resetCache()},ttAdapter:function(){return e.bind(this.get,this)}});return h})(this);E='<span class="twitter-typeahead"></span>';F='<span class="tt-dropdown-menu"></span>';G='<div class="tt-dataset-%CLASS%"></div>';H='<span class="tt-suggestions"></span>';
I='<div class="tt-suggestion"></div>';w={position:"relative",display:"inline-block"};x={position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none"};s={position:"relative",verticalAlign:"top",backgroundColor:"transparent"};y={position:"relative",verticalAlign:"top"};z={position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"};A={display:"block"};B={whiteSpace:"normal"};C={left:"0",right:"auto"};D={left:"auto",right:" 0"};e.isMsie()&&e.mixin(s,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"});
e.isMsie()&&7>=e.isMsie()&&e.mixin(s,{marginTop:"-1px"});var M=function(){function b(b){b&&b.el||g.error("EventBus initialized without el");this.$el=g(b.el)}e.mixin(b.prototype,{trigger:function(b){var d=[].slice.call(arguments,1);this.$el.trigger("typeahead:"+b,d)}});return b}(),v=function(){function b(a,f,b,e){if(!b)return this;f=f.split(c);b=e?d(b,e):b;for(this._callbacks=this._callbacks||{};e=f.shift();)this._callbacks[e]=this._callbacks[e]||{sync:[],async:[]},this._callbacks[e][a].push(b);return this}
function e(a,c,b){return function(){for(var d,e=0;!d&&e<a.length;e+=1)d=!1===a[e].apply(c,b);return!d}}function d(a,c){return a.bind?a.bind(c):function(){a.apply(c,[].slice.call(arguments,0))}}var c=/\s+/,a=function(){return window.setImmediate?function(a){setImmediate(function(){a()})}:function(a){setTimeout(function(){a()},0)}}();return{onSync:function(a,c,d){return b.call(this,"sync",a,c,d)},onAsync:function(a,c,d){return b.call(this,"async",a,c,d)},off:function(a){var b;if(!this._callbacks)return this;
for(a=a.split(c);b=a.shift();)delete this._callbacks[b];return this},trigger:function(b){var f,d,g,l,q;if(!this._callbacks)return this;b=b.split(c);for(g=[].slice.call(arguments,1);(f=b.shift())&&(d=this._callbacks[f]);)l=e(d.sync,this,[f].concat(g)),q=e(d.async,this,[f].concat(g)),l()&&a(q);return this}}}(),R=function(b){function g(c,a,b){for(var f=[],d=0;d<c.length;d++)f.push(e.escapeRegExChars(c[d]));c=b?"\\b("+f.join("|")+")\\b":"("+f.join("|")+")";return a?RegExp(c):RegExp(c,"i")}var d={node:null,
pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(c){function a(a){var d,e;if(d=f.exec(a.data))wrapperNode=b.createElement(c.tagName),c.className&&(wrapperNode.className=c.className),e=a.splitText(d.index),e.splitText(d[0].length),wrapperNode.appendChild(e.cloneNode(!0)),a.parentNode.replaceChild(wrapperNode,e);return!!d}function k(a,c){for(var b,f=0;f<a.childNodes.length;f++)b=a.childNodes[f],3===b.nodeType?f+=c(b)?1:0:k(b,c)}var f;c=e.mixin({},d,c);c.node&&
c.pattern&&(c.pattern=e.isArray(c.pattern)?c.pattern:[c.pattern],f=g(c.pattern,c.caseSensitive,c.wordsOnly),k(c.node,a))}}(window.document),N=function(){function b(c){var a=this,b,f,p,h;c=c||{};c.input||g.error("input is missing");b=e.bind(this._onBlur,this);f=e.bind(this._onFocus,this);p=e.bind(this._onKeydown,this);h=e.bind(this._onInput,this);this.$hint=g(c.hint);this.$input=g(c.input).on("blur.tt",b).on("focus.tt",f).on("keydown.tt",p);0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=
this.clearHintIfInvalid=e.noop);if(e.isMsie())this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(c){d[c.which||c.keyCode]||e.defer(e.bind(a._onInput,a,c))});else this.$input.on("input.tt",h);this.query=this.$input.val();this.$overflowHelper=g('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:this.$input.css("font-family"),fontSize:this.$input.css("font-size"),fontStyle:this.$input.css("font-style"),fontVariant:this.$input.css("font-variant"),
fontWeight:this.$input.css("font-weight"),wordSpacing:this.$input.css("word-spacing"),letterSpacing:this.$input.css("letter-spacing"),textIndent:this.$input.css("text-indent"),textRendering:this.$input.css("text-rendering"),textTransform:this.$input.css("text-transform")}).insertAfter(this.$input)}function h(c){return c.altKey||c.ctrlKey||c.metaKey||c.shiftKey}var d;d={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"};b.normalizeQuery=function(c){return(c||"").replace(/^\s*/g,"").replace(/\s{2,}/g,
" ")};e.mixin(b.prototype,v,{_onBlur:function(){this.resetInputValue();this.trigger("blurred")},_onFocus:function(){this.trigger("focused")},_onKeydown:function(c){var a=d[c.which||c.keyCode];this._managePreventDefault(a,c);a&&this._shouldTrigger(a,c)&&this.trigger(a+"Keyed",c)},_onInput:function(){this._checkInputValue()},_managePreventDefault:function(c,a){var b,f;switch(c){case "tab":b=this.getHint();f=this.getInputValue();b=b&&b!==f&&!h(a);break;case "up":case "down":b=!h(a);break;default:b=!1}b&&
a.preventDefault()},_shouldTrigger:function(c,a){var b;switch(c){case "tab":b=!h(a);break;default:b=!0}return b},_checkInputValue:function(){var c,a,d;c=this.getInputValue();d=(a=b.normalizeQuery(c)===b.normalizeQuery(this.query))?this.query.length!==c.length:!1;a?d&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query=c)},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(c){this.query=
c},getInputValue:function(){return this.$input.val()},setInputValue:function(c,a){this.$input.val(c);a?this.clearHint():this._checkInputValue()},resetInputValue:function(){this.setInputValue(this.query,!0)},getHint:function(){return this.$hint.val()},setHint:function(c){this.$hint.val(c)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var c,a;c=this.getInputValue();a=this.getHint();a=c!==a&&0===a.indexOf(c);""!==c&&a&&!this.hasOverflow()||this.clearHint()},getLanguageDirection:function(){return(this.$input.css("direction")||
"ltr").toLowerCase()},hasOverflow:function(){var c=this.$input.width()-2;this.$overflowHelper.text(this.getInputValue());return this.$overflowHelper.width()>=c},isCursorAtEnd:function(){var c,a;c=this.$input.val().length;a=this.$input[0].selectionStart;return e.isNumber(a)?a===c:document.selection?(a=document.selection.createRange(),a.moveStart("character",-c),c===a.text.length):!0},destroy:function(){this.$hint.off(".tt");this.$input.off(".tt");this.$hint=this.$input=this.$overflowHelper=null}});
return b}(),t=function(){function b(a){a=a||{};a.templates=a.templates||{};a.source||g.error("missing source");a.name&&!/^[_a-zA-Z0-9-]+$/.test(a.name)&&g.error("invalid dataset name: "+a.name);this.query=null;this.highlight=!!a.highlight;this.name=a.name||e.getUniqueId();this.source=a.source;this.displayFn=h(a.display||a.displayKey);this.templates=d(a.templates,this.displayFn);this.$el=g(G.replace("%CLASS%",this.name))}function h(a){function c(b){return b[a]}a=a||"value";return e.isFunction(a)?a:
c}function d(a,c){function b(a){return"<p>"+c(a)+"</p>"}return{empty:a.empty&&e.templatify(a.empty),header:a.header&&e.templatify(a.header),footer:a.footer&&e.templatify(a.footer),suggestion:a.suggestion||b}}var c="ttDataset",a="ttValue",k="ttDatum";b.extractDatasetName=function(a){return g(a).data(c)};b.extractValue=function(c){return g(c).data(a)};b.extractDatum=function(a){return g(a).data(k)};e.mixin(b.prototype,v,{_render:function(b,d){function h(){var l,r;l=g(H).css(A);r=e.map(d,function(b){b=
g(I).append(m.templates.suggestion(b)).data(c,m.name).data(a,m.displayFn(b)).data(k,b);b.children().each(function(){g(this).css(B)});return b});l.append.apply(l,r);m.highlight&&R({node:l[0],pattern:b});return l}function l(){return m.templates.header({query:b,isEmpty:!n})}function q(){return m.templates.footer({query:b,isEmpty:!n})}if(this.$el){var m=this,n;this.$el.empty();n=d&&d.length;!n&&this.templates.empty?this.$el.html(m.templates.empty({query:b,isEmpty:!0})).prepend(m.templates.header?l():
null).append(m.templates.footer?q():null):n&&this.$el.html(h()).prepend(m.templates.header?l():null).append(m.templates.footer?q():null);this.trigger("rendered")}},getRoot:function(){return this.$el},update:function(a){var c=this;this.query=a;this.canceled=!1;this.source(a,function(b){c.canceled||a!==c.query||c._render(a,b)})},cancel:function(){this.canceled=!0},clear:function(){this.cancel();this.$el.empty();this.trigger("rendered")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=
null}});return b}(),S=function(){function b(b){var c=this,a,k,f;b=b||{};b.menu||g.error("menu is required");this.isOpen=!1;this.isEmpty=!0;this.datasets=e.map(b.datasets,h);a=e.bind(this._onSuggestionClick,this);k=e.bind(this._onSuggestionMouseEnter,this);f=e.bind(this._onSuggestionMouseLeave,this);this.$menu=g(b.menu).on("click.tt",".tt-suggestion",a).on("mouseenter.tt",".tt-suggestion",k).on("mouseleave.tt",".tt-suggestion",f);e.each(this.datasets,function(a){c.$menu.append(a.getRoot());a.onSync("rendered",
c._onRendered,c)})}function h(b){return new t(b)}e.mixin(b.prototype,v,{_onSuggestionClick:function(b){this.trigger("suggestionClicked",g(b.currentTarget))},_onSuggestionMouseEnter:function(b){this._removeCursor();this._setCursor(g(b.currentTarget),!0)},_onSuggestionMouseLeave:function(){this._removeCursor()},_onRendered:function(){(this.isEmpty=e.every(this.datasets,function(b){return b.isEmpty()}))?this._hide():this.isOpen&&this._show();this.trigger("datasetRendered")},_hide:function(){this.$menu.hide()},
_show:function(){this.$menu.css("display","block")},_getSuggestions:function(){return this.$menu.find(".tt-suggestion")},_getCursor:function(){return this.$menu.find(".tt-cursor").first()},_setCursor:function(b,c){b.first().addClass("tt-cursor");!c&&this.trigger("cursorMoved")},_removeCursor:function(){this._getCursor().removeClass("tt-cursor")},_moveCursor:function(b){var c,a;this.isOpen&&(a=this._getCursor(),c=this._getSuggestions(),this._removeCursor(),b=c.index(a)+b,b=(b+1)%(c.length+1)-1,-1===
b?this.trigger("cursorRemoved"):(-1>b&&(b=c.length-1),this._setCursor(c=c.eq(b)),this._ensureVisible(c)))},_ensureVisible:function(b){var c,a,e;c=b.position().top;b=c+b.outerHeight(!0);a=this.$menu.scrollTop();e=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10);0>c?this.$menu.scrollTop(a+c):e<b&&this.$menu.scrollTop(a+(b-e))},close:function(){this.isOpen&&(this.isOpen=!1,this._removeCursor(),this._hide(),this.trigger("closed"))},open:function(){this.isOpen||
(this.isOpen=!0,!this.isEmpty&&this._show(),this.trigger("opened"))},setLanguageDirection:function(b){this.$menu.css("ltr"===b?C:D)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getDatumForSuggestion:function(b){var c=null;b.length&&(c={raw:t.extractDatum(b),value:t.extractValue(b),datasetName:t.extractDatasetName(b)});return c},getDatumForCursor:function(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function(){return this.getDatumForSuggestion(this._getSuggestions().first())},
update:function(b){e.each(this.datasets,function(c){c.update(b)})},empty:function(){e.each(this.datasets,function(b){b.clear()});this.isEmpty=!0},isVisible:function(){return this.isOpen&&!this.isEmpty},destroy:function(){this.$menu.off(".tt");this.$menu=null;e.each(this.datasets,function(b){b.destroy()})}});return b}(),T=function(){function b(a){var b,c,d;a=a||{};a.input||g.error("missing input");this.isActivated=!1;this.autoselect=!!a.autoselect;this.minLength=e.isNumber(a.minLength)?a.minLength:
1;this.$node=h(a.input,a.withHint);b=this.$node.find(".tt-dropdown-menu");c=this.$node.find(".tt-input");d=this.$node.find(".tt-hint");c.on("blur.tt",function(a){var d,g;d=document.activeElement;g=b.is(d);d=0<b.has(d).length;e.isMsie()&&(g||d)&&(a.preventDefault(),a.stopImmediatePropagation(),e.defer(function(){c.focus()}))});b.on("mousedown.tt",function(a){a.preventDefault()});this.eventBus=a.eventBus||new M({el:c});this.dropdown=(new S({menu:b,datasets:a.datasets})).onSync("suggestionClicked",this._onSuggestionClicked,
this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onAsync("datasetRendered",this._onDatasetRendered,this);this.input=(new N({input:c,hint:d})).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,
this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this);this._setLanguageDirection()}function h(a,b){var d,e,h,l;d=g(a);e=g(E).css(w);h=g(F).css(z);l=d.clone().css(x).css({backgroundAttachment:d.css("background-attachment"),backgroundClip:d.css("background-clip"),backgroundColor:d.css("background-color"),backgroundImage:d.css("background-image"),
backgroundOrigin:d.css("background-origin"),backgroundPosition:d.css("background-position"),backgroundRepeat:d.css("background-repeat"),backgroundSize:d.css("background-size")});l.val("").removeData().addClass("tt-hint").removeAttr("id name placeholder").prop("disabled",!0).attr({autocomplete:"off",spellcheck:"false"});d.data(c,{dir:d.attr("dir"),autocomplete:d.attr("autocomplete"),spellcheck:d.attr("spellcheck"),style:d.attr("style")});d.addClass("tt-input").attr({autocomplete:"off",spellcheck:!1}).css(b?
s:y);try{!d.attr("dir")&&d.attr("dir","auto")}catch(q){}return d.wrap(e).parent().prepend(b?l:null).append(h)}function d(a){var b=a.find(".tt-input");e.each(b.data(c),function(a,c){e.isUndefined(a)?b.removeAttr(c):b.attr(c,a)});b.detach().removeData(c).removeClass("tt-input").insertAfter(a);a.remove()}var c="ttAttrs";e.mixin(b.prototype,{_onSuggestionClicked:function(a,b){var c;(c=this.dropdown.getDatumForSuggestion(b))&&this._select(c)},_onCursorMoved:function(){var a=this.dropdown.getDatumForCursor();
this.input.setInputValue(a.value,!0);this.eventBus.trigger("cursorchanged",a.raw,a.datasetName)},_onCursorRemoved:function(){this.input.resetInputValue();this._updateHint()},_onDatasetRendered:function(){this._updateHint()},_onOpened:function(){this._updateHint();this.eventBus.trigger("opened")},_onClosed:function(){this.input.clearHint();this.eventBus.trigger("closed")},_onFocused:function(){this.isActivated=!0;this.dropdown.open()},_onBlurred:function(){this.isActivated=!1;this.dropdown.empty();
this.dropdown.close()},_onEnterKeyed:function(a,b){var c,d;c=this.dropdown.getDatumForCursor();d=this.dropdown.getDatumForTopSuggestion();c?(this._select(c),b.preventDefault()):this.autoselect&&d&&(this._select(d),b.preventDefault())},_onTabKeyed:function(a,b){var c;(c=this.dropdown.getDatumForCursor())?(this._select(c),b.preventDefault()):this._autocomplete(!0)},_onEscKeyed:function(){this.dropdown.close();this.input.resetInputValue()},_onUpKeyed:function(){var a=this.input.getQuery();this.dropdown.isEmpty&&
a.length>=this.minLength?this.dropdown.update(a):this.dropdown.moveCursorUp();this.dropdown.open()},_onDownKeyed:function(){var a=this.input.getQuery();this.dropdown.isEmpty&&a.length>=this.minLength?this.dropdown.update(a):this.dropdown.moveCursorDown();this.dropdown.open()},_onLeftKeyed:function(){"rtl"===this.dir&&this._autocomplete()},_onRightKeyed:function(){"ltr"===this.dir&&this._autocomplete()},_onQueryChanged:function(a,b){this.input.clearHintIfInvalid();b.length>=this.minLength?this.dropdown.update(b):
this.dropdown.empty();this.dropdown.open();this._setLanguageDirection()},_onWhitespaceChanged:function(){this._updateHint();this.dropdown.open()},_setLanguageDirection:function(){var a;this.dir!==(a=this.input.getLanguageDirection())&&(this.dir=a,this.$node.css("direction",a),this.dropdown.setLanguageDirection(a))},_updateHint:function(){var a,b,c;(a=this.dropdown.getDatumForTopSuggestion())&&this.dropdown.isVisible()&&!this.input.hasOverflow()?(b=this.input.getInputValue(),c=N.normalizeQuery(b),
c=e.escapeRegExChars(c),c=RegExp("^(?:"+c+")(.+$)","i"),(a=c.exec(a.value))?this.input.setHint(b+a[1]):this.input.clearHint()):this.input.clearHint()},_autocomplete:function(a){var b,c;b=this.input.getHint();c=this.input.getQuery();a=a||this.input.isCursorAtEnd();b&&c!==b&&a&&((b=this.dropdown.getDatumForTopSuggestion())&&this.input.setInputValue(b.value),this.eventBus.trigger("autocompleted",b.raw,b.datasetName))},_select:function(a){this.input.setQuery(a.value);this.input.setInputValue(a.value,
!0);this._setLanguageDirection();this.eventBus.trigger("selected",a.raw,a.datasetName);this.dropdown.close();e.defer(e.bind(this.dropdown.empty,this.dropdown))},open:function(){this.dropdown.open()},close:function(){this.dropdown.close()},setVal:function(a){this.isActivated?this.input.setInputValue(a):(this.input.setQuery(a),this.input.setInputValue(a,!0));this._setLanguageDirection()},getVal:function(){return this.input.getQuery()},destroy:function(){this.input.destroy();this.dropdown.destroy();
d(this.$node);this.$node=null}});return b}();(function(){var b,h,d;b=g.fn.typeahead;h="ttTypeahead";d={initialize:function(b,a){a=e.isArray(a)?a:[].slice.call(arguments,1);b=b||{};return this.each(function(){var d=g(this),f;e.each(a,function(a){a.highlight=!!b.highlight});f=new T({input:d,eventBus:new M({el:d}),withHint:e.isUndefined(b.hint)?!0:!!b.hint,minLength:b.minLength,autoselect:b.autoselect,datasets:a});d.data(h,f)})},open:function(){return this.each(function(){var b;(b=g(this).data(h))&&
b.open()})},close:function(){return this.each(function(){var b;(b=g(this).data(h))&&b.close()})},val:function(b){function a(){var a;(a=g(this).data(h))&&a.setVal(b)}function d(a){var b;if(a=a.data(h))b=a.getVal();return b}return arguments.length?this.each(a):d(this.first())},destroy:function(){return this.each(function(){var b=g(this),a;if(a=b.data(h))a.destroy(),b.removeData(h)})}};g.fn.typeahead=function(b){return d[b]?d[b].apply(this,[].slice.call(arguments,1)):d.initialize.apply(this,arguments)};
g.fn.typeahead.noConflict=function(){g.fn.typeahead=b;return this}})()})(window.jQuery);
